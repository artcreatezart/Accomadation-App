/* jshint esversion: 6 */

const accomadation = [{
    id: 1,
    accomadationImage1: "./img/accomadation/wellington-hotel-1.webp",
    accomadationImage2: "./img/accomadation/wellington-hotel-2.webp",
    accomadationImage3: "./img/accomadation/wellington-hotel-3.webp",
    name: "Cippy Hotel",
    type: "Hotel",
    price: "$157",
    minGuests: "1",
    maxGuests: "2",
    minStay: "1",
    maxStay: "5",
    bedrooms: "2",
    bathrooms: "1",
    parking: "no",
    kidFriendly: "yes",
    location: "Wellington",
    accomadationInfo: "Here at Cippy Hotel we pride ourselves on service and quality. A perfect location, for a perfect stay. At $157 a night you can get a cosy room with 2 bedrooms, a seperate bathroom, and a spacious lounge and Kitchen. Plus Free Wifi. <br> <br>We offer an inclusive breakfast buffet from 5am to 9am don't miss out.",
    accomadationLongitude: "174.7786201350749",
    accomadationLatitude: "-41.2933537357573",

}, {
    id: 2,
    accomadationImage1: "./img/accomadation/christchurch-hostel-1.webp",
    accomadationImage2: "./img/accomadation/christchurch-hostel-2.webp",
    accomadationImage3: "./img/accomadation/christchurch-hostel-3.webp",
    name: "Bolas's Hostel",
    type: "Hostel",
    price: "$30",
    minGuests: "1",
    maxGuests: "1",
    minStay: "1",
    maxStay: "10",
    bedrooms: "1",
    bathrooms: "1",
    parking: "no",
    kidFriendly: "no",
    location: "Auckland",
    accomadationInfo: "Traveling alone and looking for accomadation thats both in the perfect location and afforable? Bolas's Hostle is the place for you. <br> <br> Here you share a space with other visitors, you are provided with a bed and space to store you items, and you share the rest of the space such as bathrooms, showers, kitchen and lounges with the others. A perfect place if your looking for somewhere afforable, love getting to know Guests and needing somewhere to stay in between adventures.",
    accomadationLongitude: "174.757619453614",
    accomadationLatitude: "-36.85156957211987",

}, {
    id: 3,
    accomadationImage1: "./img/accomadation/hawkes-motel-1.webp",
    accomadationImage2: "./img/accomadation/hawkes-motel-2.webp",
    accomadationImage3: "./img/accomadation/hawkes-motel-3.webp",
    name: "Hawkes Lane Motel",
    type: "Motel",
    price: "$90",
    minGuests: "2",
    maxGuests: "4",
    minStay: "3",
    maxStay: "10",
    bedrooms: "2",
    bathrooms: "2",
    parking: "yes",
    kidFriendly: "no",
    location: "Napier",
    accomadationInfo: "Hawkes Lane Motel is in a supreme spot around shops and awesome senic outlooks. While your here you can easily walk to many cafes, resturants, shops and some of the most beautiful walks. <br> <br> Here you will get 2 bedrooms, with 3 beds, 2 bathrooms and common area. You will have access to the motels pool and pool tables which is a perfect place to pass time.",
    accomadationLongitude: "172.64084119719655",
    accomadationLatitude: "-43.540551101065816",

}, {
    id: 4,
    accomadationImage1: "./img/accomadation/auckland-house-1.webp",
    accomadationImage2: "./img/accomadation/auckland-house-2.webp",
    accomadationImage3: "./img/accomadation/auckland-house-3.webp",
    name: "Jiolan House",
    type: "House",
    price: "$240",
    minGuests: "1",
    maxGuests: "4",
    minStay: "2",
    maxStay: "15",
    bedrooms: "3",
    bathrooms: "2",
    parking: "yes",
    kidFriendly: "yes",
    location: "Wellington",
    accomadationInfo: "This house if perfect for those looking for a private place to stay on your vacation where you can have the house to yourself and perfect for a family, friends or when multiple Guests are staying. <br><br> At the Jiolan House there are 3 bedrooms, 3 beds, a kitchen, 2 bathrooms, 2 common areas, a dining room, outdoor area and a kitchen.",
    accomadationLongitude: "174.77209913051644",
    accomadationLatitude: "-41.29103210801465",

}, {
    id: 5,
    accomadationImage1: "./img/accomadation/napier-house-1.webp",
    accomadationImage2: "./img/accomadation/napier-house-2.webp",
    accomadationImage3: "./img/accomadation/napier-house-3.webp",
    name: "Dreamy Aquatic House",
    type: "House",
    price: "$240",
    minGuests: "2",
    maxGuests: "6",
    minStay: "3",
    maxStay: "18",
    bedrooms: "4",
    bathrooms: "2",
    parking: "no",
    kidFriendly: "yes",
    location: "Napier",
    accomadationInfo: "This house is so convient for location with everything you could possibly need within walking distance. Dreamy Aquatic House is a 2 storey house with plenty of room and a beautifu view of the gorgeous water.<br><br> Includes 4 bedrooms, 5 beds, 2 bathrooms, 1 kitchen, 2 lounge areas, a garage, outdoor space and 1 parking space. Imagine youself waking up on a brisk cool morning with a hot coffee in your hands as you glance over the crisp clear blue water amongst Napier.",
    accomadationLongitude: "176.9169491447278",
    accomadationLatitude: "-39.48896470680778",


}, {
    id: 6,
    accomadationImage1: "./img/accomadation/hamilton-hotel-1.webp",
    accomadationImage2: "./img/accomadation/hamilton-hotel-2.webp",
    accomadationImage3: "./img/accomadation/hamilton-hotel-3.webp",
    name: "Luxury Stay Motel",
    type: "Motel",
    price: "$90",
    minGuests: "2",
    maxGuests: "4",
    minStay: "3",
    maxStay: "10",
    bedrooms: "3",
    bathrooms: "2",
    parking: "no",
    kidFriendly: "no",
    location: "Christchurch",
    accomadationInfo: "Luxury Stay Motel is a a luxury experience without the overpriced aspect. Enjoy a magnificent view from our 3 story building, imagine waking up the the warmth of the beutiful morning sun to start off you adventure of the day. <br><br> This hotel room is spacious with 3 bedroom, 4 beds, 2 bathroom, 1 lounge area and a kitchen area. Perfect when looking for a place to stay on your adventure for 2-4 Guests.",
    accomadationLongitude: "172.62164982955926",
    accomadationLatitude: "-43.530446374259405",

}];


const zoos = [{
    zooId: 1,
    zoo: "Wellington Zoo",
    zooImage1: "./img/zoo/wellington-zoo-1.webp",
    zooImage2: "./img/zoo/wellington-zoo-2.webp",
    zooImage3: "./img/zoo/wellington-zoo-3.webp",
    zooInfo: "Fun! Adventures! Animals! Come to Wellington Zoo, here we have so many cool and unique animals to see. Check out the animals you can come see, we've got snow leopards, meerkats, lions, spides, lizards, capybaras, giraffes and so much MORE!! We have so many things you can do. <br> <br> Try out some of our many exciting activites such as Close Encounters, Zoo Sleepovers, Holiday programme and heapes of Learning Experiences. Newest additions. For any questions give us a call to talk to one of our helpful staff. ",
    zooDays: "Monday to Sunday",
    zooHours: "9:30am to 5pm EVERY DAY",
    zooPhone: "04 381 6755",
    zooLocation: "Wellington",
    zooAddress: "200 Daniell Street, Newtown, Wellington 6021",
    zooWebsite: "https://wellingtonzoo.com/",
    zooLongitude: "174.78448912403508",
    zooLatitude: "-41.31924239208882",

}, {
    zooId: 2,
    zoo: "Orana Wildlife Park",
    zooImage1: "./img/zoo/christchurch-zoo-1.webp",
    zooImage2: "./img/zoo/christchurch-zoo-2.webp",
    zooImage3: "./img/zoo/christchurch-zoo-3.webp",
    zooInfo: "Fun! Adventures! Animals! Come on down to Orana Wildlife Park here we have so many cool and unique animals to see. A wonderful open-range zoo with so much to discover.",
    zooDays: "Monday to Sunday",
    zooHours: "10am to 5pm EVERY DAY",
    zooPhone: "03 359 7109",
    zooLocation: "Christchurch",
    zooAddress: "793 McLeans Island Road, Harewood, Christchurch 8051",
    zooWebsite: "https://www.oranawildlifepark.co.nz/",
    zooLongitude: "172.46307237770145",
    zooLatitude: "-43.467010046710655",
}, {
    zooId: 3,
    zoo: "Hawkes Bay Farmyard Zoo",
    zooImage1: "./img/zoo/hawkes-zoo-1.webp",
    zooImage2: "./img/zoo/hawkes-zoo-2.webp",
    zooImage3: "./img/zoo/hawkes-zoo-3.webp",
    zooInfo: "Animals at every corner. What could get better than that, perfect for a great day out, enjoying the outdoors while having things to see. If your wanting to experience something different than a zoo thats more open and has more closure to the animals this is the perfect place. Its a wonderful place to go with family, friends or even just a day by yourself. ",
    zooDays: "Monday to Sunday",
    zooHours: "10am to 5pm EVERY DAY",
    zooPhone: "068750244",
    zooLocation: "Napier",
    zooAddress: "R.D 10/32 East Road, Haumoana 4180",
    zooWebsite: "http://www.farmyardzoo.co.nz/",
    zooLongitude: "176.83413325329315",
    zooLatitude: "-39.73983213420209",
}, {
    zooId: 4,
    zoo: "National Aquarium of New Zealand",
    zooImage1: "./img/zoo/napier-zoo-1.webp",
    zooImage2: "./img/zoo/napier-zoo-2.webp",
    zooImage3: "./img/zoo/napier-zoo-3.webp",
    zooInfo: "Whether it's rain or shine the National Aquarium of New Zealand is a fun and exciting activity to spend you day checking out. Its fun for the whole family, with heaps to explore and discover. <br><br> With a stunning location of along the marin parade its great to bring a picnic along and visit the aquarium to then spening time out in the sunshine with a beautiful view. ",
    zooDays: "Monday to Sunday",
    zooHours: "9am to 5pm EVERY DAY",
    zooPhone: "068341404",
    zooLocation: "Napier",
    zooAddress: "546 Marine Parade, Napier South, Napier 4110",
    zooWebsite: "https://www.nationalaquarium.co.nz/",
    zooLongitude: "176.91896097441412",
    zooLatitude: "-39.500558075187094",
}, {
    zooId: 5,
    zoo: "Auckland Zoo",
    zooImage1: "./img/zoo/auckland-zoo-1.webp",
    zooImage2: "./img/zoo/auckland-zoo-2.webp",
    zooImage3: "./img/zoo/auckland-zoo-3.webp",
    zooInfo: "Auckland Zoo is New Zealands largest zoo and is a must see with over 130 species and 900 animals. With so much to explore and discover its a perfect activity to do on a empty day in your travels. Whether rain or shine this place always thrives and makes the most of ever day! Espeically being able to see how each animal works under different weather is always special and interesting.",
    zooDays: "Monday to Sunday",
    zooHours: "9:30am to 4:30pm EVERY DAY",
    zooPhone: "093603805",
    zooLocation: "Auckland",
    zooAddress: "Motions Rd, Western Springs, Auckland 1022",
    zooWebsite: "https://www.aucklandzoo.co.nz/",
    zooLongitude: "174.72040766752255",
    zooLatitude: "-36.84340051993856",
}];

$(document).ready(function () {
    // Fullpage Init:
    new fullpage('#fullpage', {
        licenseKey: 'gplv3-license',
        controlArrows: false,
        fixedElements: "#navbar",
    });

    fullpage_api.setAllowScrolling(false);

    // Swiper Init:
    let swiper = new Swiper('.swiper', {
        // Optional parameters
        direction: 'horizontal',
        // If we need pagination
        pagination: {
            el: '.swiper-pagination',
        },

        // Navigation arrows
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
    });


    // populateLocationOptions();

    function validateFilters() {

        let isValid = true;
        let errorMessage = "";

        if ($('#location').val() === "") {
            isValid = false;
            errorMessage += "Please Select a Location.<br>";
        }
        if ($("#guests").val() === "") {
            isValid = false;
            errorMessage += "Please Select the Number of Guests.<br>";
        }
        if ($("#startDate").val() === "") {
            isValid = false;
            errorMessage += "Please Select Start Date of Stay.<br>";
        }
        if ($("#endDate").val() === "") {
            isValid = false;
            errorMessage += "Please Select End Date of Stay.<br>";
        }
        if (!isValid) {
            $('#errorMessage').html(errorMessage).show();
        } else {
            $('#errorMessage').hide();
        }
        return isValid;
    }


    function filterAndDisplayAccomadations() {
        const selectedLocation = $('#location').val();
        const guests = parseInt($('#guests').val(), 10) || 0;
        const selectedType = $('#type').val();
        const kidFriendly = $('#kidFriendly').val();
        const parking = $('#carPark').val();
        const diffDays = calculateDays();
        console.log(diffDays);
        // const budgetFilterPrice = calculateBudgetFilterPrice();
        // console.log(budgetFilterPrice);

        const filteredAccomadations = accomadation.filter(accomadation => {
            return (accomadation.location === selectedLocation || selectedLocation === '') &&
                (parseInt(accomadation.minGuests, 10) <= guests) &&
                (parseInt(accomadation.maxGuests, 10) >= guests) &&
                (accomadation.kidFriendly === kidFriendly || kidFriendly === '') &&
                (accomadation.parking === parking || parking === '') &&
                (accomadation.type === selectedType || selectedType === '') &&
                (accomadation.minStay <= diffDays) &&
                (accomadation.maxStay >= diffDays);
                // (accomadation.minPrice <= budgetFilterPrice) &&
                // (accomadation.maxPrice >= budgetFilterPrice)
        });


        console.log(filteredAccomadations);
        displayAccomadations(filteredAccomadations);
    }


    function calculateDays() {
        const startDate = $("#startDate").datepicker("getDate");
        const endDate = $("#endDate").datepicker("getDate");

        if (startDate && endDate) {
            const timeDiff = Math.abs(endDate.getTime() - startDate.getTime());
            const diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
            return diffDays;
        } else {
            return 0;
        }


    }

    // function calculateBudgetFilterPrice() {
    //     const minPrice = $("#minPrice").select("getPrice");
    //     const maxPrice = $("#maxPrice").select("getPrice");

    // }



    function displayAccomadations(filteredAccomadations) {
        const accomadationsPerPageSmall = 1;
        const accomadationsPerPageMedium = 2;
        const accomadationsPerPageLarge = 3;

        function getAccomadationsPerPage() {
            if (window.matchMedia('(max-width: 768px)').matches) {
                return accomadationsPerPageSmall;
            } else if (window.matchMedia('(max-width: 1200px)').matches) {
                return accomadationsPerPageMedium;
            } else {
                return accomadationsPerPageLarge;
            }
        }

        let accomadationsPerPage = getAccomadationsPerPage();

        const swiperWrapper = $('.swiper-wrapper');
        // empty the swiper
        swiperWrapper.empty();

        for (let i = 0; i < filteredAccomadations.length; i += accomadationsPerPage) {
            const slide = $('<div class="swiper-slide"></div>'); // each slide

            for (let j = i; j < i + accomadationsPerPage && j < filteredAccomadations.length; j++) {
                const accomadation = filteredAccomadations[j];
                const accomadationElement = `
            <div class="card-container">
            <div class="img-container"></div>
            <div class="card-info-container">
                <h2>${accomadation.name}</h2>
                <div class="location-info-container">
                    <h5>${accomadation.type}</h5>
                    <i class="fa-solid fa-location-dot"></i>
                    <h4>${accomadation.location}</h4>
                </div>
                <div class="card-info-left-container">
                    <div class="guests-info">
                        <i class="fa-solid fa-user"></i>
                        <h6>${accomadation.minGuests} - ${accomadation.maxGuests} Guests</h6>
                    </div>
                    <div class="nights-info">
                        <i class="fa-solid fa-moon"></i>
                        <h6>${accomadation.minStay} - ${accomadation.maxStay} Nights</h6>
                    </div>
                    <div class="ammenites-info">
                        <div class="bedroom-info">
                            <h6>${accomadation.bedrooms}</h6>
                            <i class="fa-solid fa-bed"></i>
                        </div>
                        <div class="bathrooms-info">
                            <h6>${accomadation.bathrooms}</h6>
                            <i class="fa-solid fa-toilet"></i>
                        </div>
                    </div>
                </div>
                <div class="card-info-right-container">
                    <div class="extra-info">
                        <i class="fa-solid fa-car" id="carIcon"></i>
                        <i class="fa-solid fa-child" id="childIcon"></i>
                    </div>
                    <h2>${accomadation.price} / night</h2>
                    <button class="primary-button" id="seeMoreAccomadationButton">See More<i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>
        </div>
              `;
                slide.append(accomadationElement);
            }
            swiperWrapper.append(slide);
        }
        // Destroy the swiper instance
        swiper.destroy(true, true);
        
        // initalise a new one
        swiper = new Swiper('.swiper', {
            direction: 'horizontal',
            pagination: {
                el: '.swiper-pagination',
            }
        });

        // Rebuild Fullpage to see the new slides
        fullpage_api.reBuild();

    }

    // Date picker formats
    $("#startDate").datepicker({
        dateFormat: "dd/mm/yy"
    });
    $("#endDate").datepicker({
        dateFormat: "dd/mm/yy"
    });

    // BUTTON FUCNTIONS STARTS
    $("#findARoomButton").click(function (e) {
        e.preventDefault();
        fullpage_api.moveTo(2, 0);
    });

    $("#searchButton").click(function (e) {
        e.preventDefault();
        if (validateFilters()) {
            fullpage_api.moveTo(2, 1);
            filterAndDisplayAccomadations();
        }
    });

    $("#backButton").click(function (e) {
        e.preventDefault();
        fullpage_api.moveTo(2, 0);
    });

    // BUTTON FUCNTIONS ENDS



});